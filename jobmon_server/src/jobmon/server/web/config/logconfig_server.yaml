# Server-specific logconfig for jobmon
# Console logging by default, OTLP can be enabled via configuration overrides

version: 1
disable_existing_loggers: true

# Import shared formatters and handlers from core templates
formatters: !template formatters

# Server handlers (simple handlers inline, complex ones templated)  
handlers:
  # Simple console handlers (inlined - no templates needed)
  console_default:
    class: logging.StreamHandler
    level: INFO
    formatter: console_default
    
  console_structlog:
    class: logging.StreamHandler
    level: INFO
    formatter: structlog_event_only

# Server logger configurations (console by default, OTLP via config overrides)
loggers:
  # Server web module
  jobmon.server.web:
    handlers: [console_structlog]  # Console only - OTLP added via overrides
    level: INFO
    propagate: false

  # Standard server library loggers using shared console pattern
  sqlalchemy:
    handlers: [console_default]
    level: WARN
    propagate: false


# OTLP can be enabled via configuration overrides:
# 
# Example file-based override (logging.server_logconfig_file):
# handlers:
#   otlp_server:
#     class: jobmon.core.otlp.JobmonOTLPLoggingHandler
#     level: INFO
#     formatter: otlp_default
#     exporter:
#       module: opentelemetry.exporter.otlp.proto.grpc._log_exporter
#       class: OTLPLogExporter
#       endpoint: http://localhost:4317
#       timeout: 30
#       insecure: true
# loggers:
#   jobmon.server.web:
#     handlers: [console_structlog, otlp_server]
#
# Example section-based override (logging.server.*):
# logging:
#   server:
#     handlers:
#       otlp_server: { ... }
#     loggers:
#       jobmon.server.web:
#         handlers: [console_structlog, otlp_server] 
# Server-specific logconfig for jobmon WITH OTLP ENABLED
# This uses shared templates from core and enables OTLP logging for all server logs

version: 1
disable_existing_loggers: false

# Import shared formatters and handlers from core templates
formatters: !template formatters

# Server handlers using shared templates  
handlers:
  # Use shared console handler patterns
  console_default: !template handlers.console_template
  console_structlog: !template handlers.console_structlog_template
  console_json: !template handlers.console_json_template

  # OTLP handlers using complete templates (no merge needed)
  otlp_server: !template handlers.otlp_complete_template
  otlp_structlog: !template handlers.otlp_structlog_complete_template

# Server logger configurations WITH OTLP ENABLED
loggers:
  # Server jobmon logging with structlog (console + OTLP enabled)
  jobmon:
    handlers: [console_structlog, otlp_structlog]  # OTLP ENABLED
    level: INFO
    propagate: false

  # Server web module (console + OTLP enabled)
  jobmon.server.web:
    handlers: [console_structlog, otlp_structlog]  # OTLP ENABLED
    level: INFO
    propagate: false

  # Standard server library loggers (console + OTLP enabled)
  sqlalchemy:
    handlers: [console_default, otlp_server]  # OTLP ENABLED
    level: WARN
    propagate: false

  uvicorn.access:
    handlers: [console_default, otlp_server]  # OTLP ENABLED
    level: INFO
    propagate: false

  uvicorn.error:
    handlers: [console_default, otlp_server]  # OTLP ENABLED
    level: INFO
    propagate: false

# Root logger fallback (console only)
root:
  handlers: [console_default]
  level: WARNING 